name: Publish packages to Nuget

inputs:
  token:
    description: |
      GitHub personal access token that this action should use. This should be configured using a Secret.
    required: true
  owner:
    description: |
      The owner of the GitHub Packages where to push.
    required: true

runs:
  using: composite
  steps:
    - name: Setup dotnet
      uses: actions/setup-dotnet@baa11fbfe1d6520db94683bd5c7a3818018e4309 # v5.1.0

    - name: Download packages artifacts
      uses: actions/download-artifact@37930b1c2abaa49bbe596cd826c3c89aef350131 # v7.0.0
      with:
        pattern: packages-*
        path: packages
        merge-multiple: true

    - name: Push to GitHub
      shell: sh
      run: dotnet nuget push packages/Microsoft.*.freebsd-*.*.nupkg --no-symbols --skip-duplicate --source https://nuget.pkg.github.com/${{ inputs.owner }}/index.json --api-key ${{ inputs.token }}
